---
import Analytics from '@vercel/analytics/astro';

interface Props {
	title?: string;
	description?: string;
}

const { title = "Lenin AGC | Portfolio", description = "Full Stack Web Developer Portfolio" } = Astro.props;

const pathname = Astro.url.pathname;
const isHome = pathname === "/";
const isBlog = pathname.startsWith("/blog");
---
<!doctype html>
<html lang="en" class="dark">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
		<meta name="description" content={description} />
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
		<!-- Prevent FOUC: apply saved theme immediately -->
		<script is:inline>
			(function() {
				const saved = localStorage.getItem('theme');
				const theme = saved || 'dark';
				document.documentElement.classList.remove('dark', 'light');
				document.documentElement.classList.add(theme);
				if (theme === 'dark') {
					document.documentElement.style.background = '#02060a';
					document.documentElement.style.color = '#f2f7ff';
				} else {
					document.documentElement.style.background = '#f5f5f7';
					document.documentElement.style.color = '#1a1a2e';
				}
			})();
		</script>
		<style>
			html.dark, html.dark body { background: #02060a; color: #f2f7ff; }
			html.light, html.light body { background: #f5f5f7; color: #1a1a2e; }
		</style>
	</head>
	<body class="min-h-screen bg-background text-foreground font-mono antialiased flex flex-col selection:bg-livekit-blue/30 selection:text-livekit-cyan">
		<header class="fixed top-0 left-0 right-0 z-50 flex justify-center pt-4 px-4 pointer-events-none">
			<div class="pointer-events-auto nav-pill flex h-14 items-center gap-1 rounded-full backdrop-blur-xl px-2 transition-all duration-300">
				{/* Logo */}
				<a href="/" class="group flex items-center gap-1.5 px-4 text-lg font-bold tracking-tight transition-all duration-300">
					<span class="text-foreground group-hover:text-livekit-cyan transition-colors duration-300">Lenin</span>
					<span class="text-livekit-blue group-hover:text-livekit-cyan transition-colors duration-300">AGC</span>
				</a>

				{/* Separator */}
				<div class="nav-sep h-5 w-px mx-1"></div>

				{/* Nav links */}
				<nav class="hidden md:flex items-center gap-0.5 text-sm">
					<a href="/" class:list={[
						"relative px-4 py-1.5 rounded-full transition-all duration-300",
						isHome
							? "text-livekit-cyan bg-livekit-cyan/10"
							: "text-foreground/60 hover:text-foreground nav-link-hover"
					]}>Home</a>
					<a href="/blog" class:list={[
						"relative px-4 py-1.5 rounded-full transition-all duration-300",
						isBlog
							? "text-livekit-cyan bg-livekit-cyan/10"
							: "text-foreground/60 hover:text-foreground nav-link-hover"
					]}>Blog</a>
					<a href="https://github.com/IGUNUBLUE" target="_blank" rel="noreferrer" class="px-4 py-1.5 rounded-full text-foreground/60 hover:text-foreground nav-link-hover transition-all duration-300">GitHub</a>
				</nav>

				{/* Separator */}
				<div class="hidden md:block nav-sep h-5 w-px mx-1"></div>

				{/* Theme toggle */}
				<button 
					id="theme-toggle" 
					type="button"
					aria-label="Toggle theme"
					class="flex items-center justify-center w-9 h-9 rounded-full nav-link-hover transition-all duration-300 text-foreground/60 hover:text-foreground"
				>
					{/* Sun icon (shown in dark mode) */}
					<svg class="theme-icon-sun w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
						<circle cx="12" cy="12" r="5"></circle>
						<line x1="12" y1="1" x2="12" y2="3"></line>
						<line x1="12" y1="21" x2="12" y2="23"></line>
						<line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
						<line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
						<line x1="1" y1="12" x2="3" y2="12"></line>
						<line x1="21" y1="12" x2="23" y2="12"></line>
						<line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
						<line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
					</svg>
					{/* Moon icon (shown in light mode) */}
					<svg class="theme-icon-moon w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
						<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
					</svg>
				</button>

				{/* Separator */}
				<div class="hidden md:block nav-sep h-5 w-px mx-1"></div>

				{/* CTA */}
				<a 
					href="https://www.linkedin.com/in/lenin-agc" 
					target="_blank"
					class="hidden md:inline-flex items-center justify-center rounded-full bg-livekit-cyan/15 border border-livekit-cyan/25 px-5 py-1.5 text-sm font-medium text-livekit-cyan hover:bg-livekit-cyan/25 hover:border-livekit-cyan/40 transition-all duration-300"
				>
					LinkedIn
				</a>
			</div>
		</header>
		<main class="flex-1">
			<slot />
		</main>
		<Analytics />
		<footer class="border-t footer-border py-12 footer-bg">
			<div class="container flex flex-col items-center justify-between gap-6 md:h-24 md:flex-row">
				<div class="flex flex-col gap-2">
					<p class="text-sm font-medium tracking-tight">
						Lenin AGC <span class="text-muted-foreground font-normal">â€” Full Stack Web Dev</span>
					</p>
					<p class="text-xs text-muted-foreground">
						Built with Astro 5 & shadcn/ui. 2026 Edition.
					</p>
				</div>
				<div class="flex items-center gap-6 text-xs text-muted-foreground">
					<a href="#" class="hover:text-livekit-cyan transition-colors">Twitter</a>
					<a href="#" class="hover:text-livekit-cyan transition-colors">GitHub</a>
					<a href="#" class="hover:text-livekit-cyan transition-colors">LinkedIn</a>
				</div>
			</div>
		</footer>

		<script is:inline>
			const toggle = document.getElementById('theme-toggle');
			function updateToggleIcons() {
				const isDark = document.documentElement.classList.contains('dark');
				document.querySelectorAll('.theme-icon-sun').forEach(el => el.style.display = isDark ? 'block' : 'none');
				document.querySelectorAll('.theme-icon-moon').forEach(el => el.style.display = isDark ? 'none' : 'block');
			}
			updateToggleIcons();
			toggle.addEventListener('click', () => {
				const isDark = document.documentElement.classList.contains('dark');
				const next = isDark ? 'light' : 'dark';
				document.documentElement.classList.remove('dark', 'light');
				document.documentElement.classList.add(next);
				document.documentElement.style.background = '';
				document.documentElement.style.color = '';
				localStorage.setItem('theme', next);
				updateToggleIcons();
			});
		</script>
	</body>
</html>

<style is:global>
	@import "../styles/global.css";
	
	:root {
		font-family: 'JetBrains Mono', monospace;
	}

	header {
		-webkit-backdrop-filter: blur(20px);
	}
</style>
